@model IEnumerable<IdeaTrack.Models.Initiative>

<div class="history-container">
    <h1 class="page-title">My Initiative History</h1>
    <p class="page-subtitle">
        A chronological log of your past initiatives, outcomes, and evaluations.
    </p>

    <div class="filter-tabs">
        <button class="tab active" onclick="filterHistory('all')">All Status</button>
        <button class="tab" onclick="filterHistory('completed')">Approved</button>
        <button class="tab" onclick="filterHistory('pending')">Pending</button>
        <button class="tab" onclick="filterHistory('rejected')">Rejected</button>
    </div>

    <div class="history-list">
        @if (Model.Any())
        {
            @foreach (var item in Model)
            {
                var statusClass = item.Status switch
                {
                    IdeaTrack.Models.InitiativeStatus.Approved => "completed",
                    IdeaTrack.Models.InitiativeStatus.Rejected => "cancelled",
                    IdeaTrack.Models.InitiativeStatus.Draft => "draft",
                    _ => "pending"
                };

                <div class="history-card @statusClass" data-status="@statusClass">
                    <div class="card-left">
                        <span class="status-dot"></span>
                    </div>

                    <div class="card-content">
                        <h3>@item.Title</h3>
                        <p>
                            @(string.IsNullOrEmpty(item.Description) ? "No description provided." : (item.Description.Length > 100 ? item.Description.Substring(0, 100) + "..." : item.Description))
                        </p>
                        <div class="meta">
                            @switch (item.Status)
                            {
                                case IdeaTrack.Models.InitiativeStatus.Approved:
                                    <span class="badge completed">Approved</span>
                                    break;
                                case IdeaTrack.Models.InitiativeStatus.Rejected:
                                    <span class="badge cancelled">Rejected</span>
                                    break;
                                case IdeaTrack.Models.InitiativeStatus.Draft:
                                    <span class="badge pending">Draft</span>
                                    break;
                                case IdeaTrack.Models.InitiativeStatus.Reviewing:
                                case IdeaTrack.Models.InitiativeStatus.Dept_Review:
                                    <span class="badge review">Under Review</span>
                                    break;
                                default:
                                    <span class="badge">@item.Status</span>
                                    break;
                            }
                            <span class="date">@item.CreatedAt.ToString("MMM dd, yyyy")</span>
                        </div>
                    </div>

                    <a href="/Author/HomePage/Detail/@item.Id" class="btn-detail">View Details →</a>
                </div>
            }
        }
        else
        {
            <div class="history-card" style="text-align:center;padding:40px;">
                <p style="color:#888;">No initiatives found. <a href="/Author/HomePage/Create">Create your first one!</a></p>
            </div>
        }
    </div>
</div>

<script>
    function filterHistory(status) {
        const cards = document.querySelectorAll('.history-card[data-status]');
        const tabs = document.querySelectorAll('.filter-tabs .tab');
        
        tabs.forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
        
        cards.forEach(card => {
            if (status === 'all' || card.dataset.status === status) {
                card.style.display = 'flex';
            } else {
                card.style.display = 'none';
            }
        });
    }
</script>