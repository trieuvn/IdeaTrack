<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UEF Initiative Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="@Url.Content("/css/sample.css")" rel="stylesheet" />
    <link href="@Url.Content("/css/main.css")" rel="stylesheet" />
    <link href="@Url.Content("/css/files.css")" rel="stylesheet" />
    <link href="@Url.Content("/css/initative.css")" rel="stylesheet" />
    <link href="@Url.Content("/css/dailyreport.css")" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="/lib/favicon.ico">
    <script src="@Url.Content("/js/script.js")" defer></script>
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <div class="logo d-flex align-items-center justify-content-center">UEF</div>
            <a href="@Url.Action("Index", "HomePage")"
               class="nav @(ViewContext.RouteData.Values["action"]?.ToString() == "Index" ? "active" : "")">
                <i class="bi bi-grid fs-4"></i>
            </a>
            <a href="@Url.Action("DailyReport", "HomePage")"
               class="nav @(ViewContext.RouteData.Values["action"]?.ToString() == "DailyReport" ? "active" : "")">
                <i class="bi bi-bar-chart fs-5"></i>
            </a>
            <a href="@Url.Action("Attachments", "HomePage")"
               class="nav @(ViewContext.RouteData.Values["action"]?.ToString() == "Attachments" ? "active" : "")">
                <i class="bi bi-file-earmark-text fs-5"></i>
            </a>
            <a href="@Url.Action("History", "HomePage")"
               class="nav @(ViewContext.RouteData.Values["action"]?.ToString() == "History" ? "active" : "")">
                <i class="bi bi-clock-history"></i>
            </a>
            <a href="@Url.Action("Setting", "HomePage")"
               class="nav @(ViewContext.RouteData.Values["action"]?.ToString() == "Setting" ? "active" : "")">
                <i class="bi bi-gear fs-5"></i>
            </a>
        </aside>

        <main class="main">
            @RenderBody()
        </main>
    </div>

    
    <script>
        const logo = document.querySelector('.sidebar .logo');
        const navItems = document.querySelectorAll('.sidebar .nav');

        navItems.forEach(nav => {
          nav.addEventListener('click', () => {
            // bỏ tím logo
            logo.classList.remove('active');

            // active nav
            navItems.forEach(i => i.classList.remove('active'));
            nav.classList.add('active');
          });
        });
            document.addEventListener("DOMContentLoaded", function () {
            const fileInput = document.getElementById("fileInput");
            const fileList = document.getElementById("fileList");
            const uploadHint = document.getElementById("uploadHint");

            if (!fileInput) return;

            fileInput.addEventListener("change", function () {

                if (this.files.length === 0) return;

                uploadHint.style.display = "none";
                fileList.innerHTML = "";

                Array.from(this.files).forEach(file => {
                    const div = document.createElement("div");
                    div.className = "file";
                    div.innerHTML = `
                        <i class="bi bi-file-earmark"></i>
                        <span>${file.name}</span>
                    `;
                    fileList.appendChild(div);
                });
            });

        });
         const tabs = document.querySelectorAll('.filter-tabs .tab');
        const cards = document.querySelectorAll('.history-card');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const status = tab.textContent.trim().toLowerCase();
                cards.forEach(card => {
                    if (status === 'all status') {
                        card.style.display = 'flex';
                    } else {
                        card.style.display = card.classList.contains(status)
                            ? 'flex'
                            : 'none';
                    }
                });
            });
        });

        document.addEventListener("DOMContentLoaded", function () {
            // Hàm previewFile
            window.previewFile = function(event, fileUrl) {
                event.preventDefault();
                const preview = document.getElementById("file-preview");
                if (!preview) return;

                const extension = fileUrl.split('.').pop().toLowerCase();
                const fileName = fileUrl.split('/').pop();

                preview.innerHTML = "";
                preview.style.display = "block";

                let content = "";

                if (extension === "pdf") {
                    content = `
                        <div style="text-align:center; margin-bottom:10px; font-weight:600;">
                            ${fileName}
                        </div>
                        <iframe src="${fileUrl}"
                                style="width:100%; height:80vh; border:none; border-radius:8px;"
                                frameborder="0">
                        </iframe>
                    `;
                } else if (["jpg","jpeg","png","gif","webp","bmp"].includes(extension)) {
                    content = `
                        <div style="text-align:center; margin-bottom:10px; font-weight:600;">
                            ${fileName}
                        </div>
                        <img src="${fileUrl}"
                             style="max-width:100%; height:auto; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.1);"
                             alt="${fileName}">
                    `;
                } else if (["doc","docx"].includes(extension)) {
                    content = `
                        <div style="text-align:center; padding:40px; background:#f8fafc; border-radius:8px;">
                            <i class="bi bi-file-earmark-word-fill" style="font-size:64px; color:#1e40af;"></i>
                            <h4 style="margin:20px 0 10px;">${fileName}</h4>
                                    <p style="
            margin-bottom: 12px;
        ">Không thể xem trực tiếp file Word trong trình duyệt.</p>
                            <a href="${fileUrl}" download class="btn" style="padding:10px 20px; background:#1e40af; color:white; text-decoration:none; border-radius:6px;">
                                <i class="bi bi-download"></i> Tải xuống để xem
                            </a>
                        </div>
                    `;
                } else {
                    content = `
                        <div style="text-align:center; padding:40px; background:#f8fafc; border-radius:8px;">
                            <i class="bi bi-file-earmark" style="font-size:64px; color:#999;"></i>
                            <h4 style="margin:20px 0 10px;">${fileName}</h4>
                            <p>Không hỗ trợ xem trước loại file này.</p>
                            <a href="${fileUrl}" download style="color:#1e40af; text-decoration:underline;">Tải xuống file</a>
                        </div>
                    `;
                }

                preview.innerHTML = content;
                preview.scrollIntoView({behavior:"smooth", block:"nearest"});
            }
        });

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/4/turn.min.js"></script>


    <script>
        document.querySelectorAll('.day-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.day-btn')
                    .forEach(b => b.classList.remove('active-day'));

                btn.classList.add('active-day');

                const title = document.getElementById('panel-title');
                title.textContent = `Submissions for Oct ${btn.textContent.trim()}`;
            });
        });
    //date
        const calendarDays = document.querySelector('.calendar-days');
        const monthLabel = document.querySelector('.calendar-month');
        const prevBtn = document.querySelector('.calendar-nav-btn:first-child');
        const nextBtn = document.querySelector('.calendar-nav-btn:last-child');

        let currentDate = new Date();

        const monthNames = [
          'January', 'February', 'March', 'April', 'May', 'June',
          'July', 'August', 'September', 'October', 'November', 'December'
        ];

        // ví dụ: các ngày có activity
        const activityDays = [5, 12, 14, 22];

        function renderCalendar(date) {
          calendarDays.innerHTML = '';

          const year = date.getFullYear();
          const month = date.getMonth();

          monthLabel.textContent = `${monthNames[month]} ${year}`;

          const firstDay = new Date(year, month, 1);
          const lastDay = new Date(year, month + 1, 0);

          // JS: Sun=0 → đổi về Mon=0
          let startDay = firstDay.getDay() - 1;
          if (startDay < 0) startDay = 6;

          // ô trống đầu tháng
          for (let i = 0; i < startDay; i++) {
            calendarDays.innerHTML += `<div class="day-cell"></div>`;
          }

          for (let day = 1; day <= lastDay.getDate(); day++) {
            const isToday =
              day === new Date().getDate() &&
              month === new Date().getMonth() &&
              year === new Date().getFullYear();

            const hasActivity = activityDays.includes(day);

            calendarDays.innerHTML += `
              <div class="day-cell">
                <button class="day-btn
                  ${isToday ? 'active-day' : ''}
                  ${hasActivity ? 'has-activity' : ''}">
                  ${day}
                  ${hasActivity ? '<span class="dot-indicator"></span>' : ''}
                </button>
              </div>
            `;
          }
        }

        // navigation
        prevBtn.addEventListener('click', () => {
          currentDate.setMonth(currentDate.getMonth() - 1);
          renderCalendar(currentDate);
        });

        nextBtn.addEventListener('click', () => {
          currentDate.setMonth(currentDate.getMonth() + 1);
          renderCalendar(currentDate);
        });

        // init
        renderCalendar(currentDate);
    </script>


</body>
</html>
